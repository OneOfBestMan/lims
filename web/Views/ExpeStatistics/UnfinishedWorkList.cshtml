@using Model.Statistics;
@{
    ViewBag.Title = "未完成工作汇总";
    Layout = "~/Views/Share/_LayOut.cshtml";
}
<script src="~/Skins/echarts/echarts.min.js"></script>


<!--总体未完成情况统计-->
<div id="main" style="width: 98%;height:400px;"></div>

<!--未完成实验计划统计-->
<div style="height:400px;">
    <div style="float:left; width:48%;">
        <!--内容-->
        <div class="panel panel-default">
            <div class="panel-heading">
                实验计划统计
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <div style="width:100%; height:305px; overflow-x:hidden; overflow-y:auto;">
                    <table id="tab_1" class="table table-striped table-bordered table-hover">
                        <thead>
                            <tr>
                                <th>检验负责人</th>
                                <th>已完成实验计划</th>
                                <th>未完成计划数量</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                var ExpePlanStatisticslist = ViewBag.ExpePlanStatisticslist as List<E_ExpePlanStatistics>;
                                foreach (var item in ExpePlanStatisticslist)
                                {
                                    <tr>
                                        <td>@item.headpersonnename</td>
                                        <td>@item.completed</td>
                                        <td>@item.notcompleted</td>
                                    <td><a>查看明细</a></td>
                                </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- /.panel - body-->
        </div>
    </div>
    <div id="plan" style="float:right; width:48%; height:400px;">
    </div>
</div>

<!--未审批与未批准检验报告统计-->
<div style="height:400px;">
    <div style="float:left; width:48%;">
        <div class="panel panel-default">
            <div class="panel-heading">
                检验报告统计
            </div>
            <div class="panel-body">
                <table id="tab_1" class="table table-striped table-bordered table-hover">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>时间</th>
                            <th>未审批数</th>
                            <th>未批准数</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>2017年9月</td>
                            <td><a>15</a></td>
                            <td><a>20</a></td>
                            <td><a>查看报表</a></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>2017年8月</td>
                            <td><a>7</a></td>
                            <td><a>3</a></td>
                            <td><a>查看报表</a></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>2017年7月</td>
                            <td><a>6</a></td>
                            <td><a>9</a></td>
                            <td><a>查看报表</a></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- /.panel - body-->
        </div>
    </div>
    <div id="TestReport" style="float:right; width:48%; height:400px;">
    </div>
</div>

<script type="text/javascript">
    var colorList = ['#C23531', '#2F4554', '#61A0A8', '#D48265', '#91C7AE', '#749F83', '#CA8622', '#BDA29A', '#6E7074', '#546570', '#C4CCD3', '#996e55', '#02716d'];

    //总体未完成情况统计
    function GetSummaryWork()
    {
        $.getJSON("/ExpeStatistics/SummaryWork", function (result) {
            var myChart = echarts.init(document.getElementById('main'));
            var option = {
                title: {
                    text: '未完成工作',
                    subtext: '数据来自系统实时统计'
                },
                tooltip: {},
                xAxis: {
                    data: ["未完成实验计划", "未审批检验报告", "未批准检验报告"]
                },
                yAxis: {},
                series: [{
                    name: '数量',
                    type: 'bar',
                    data: eval(result).result,
                    itemStyle: {
                        normal: {
                            color: function (params) {
                                return colorList[params.dataIndex]
                            }
                        }

                    }
                }]
            };
            myChart.setOption(option);
        });
    }

    $(document).ready(function () {
        GetSummaryWork();
    });
    

    //未完成实验计划统计
    var myChart2 = echarts.init(document.getElementById('plan'));
    option2 = {
        title: {
            text: '实验计划'
        },
        tooltip: {
            trigger: 'axis',
            axisPointer: {
                type: 'shadow'
            }
        },
        legend: {
            data: ['已完成实验计划', '未完成实验计划']
        },
        grid: {
            left: '3%',
            right: '1%',
            bottom: '1%',
            containLabel: true
        },
        xAxis: {
            type: 'value',
            boundaryGap: [0, 0.01]
        },
        yAxis: {
            type: 'category',
            data: ['张三', '李四', '王五']
        },
        series: [
            {
                name: '已完成实验计划',
                type: 'bar',
                data: [120, 130, 125]
            },
            {
                name: '未完成实验计划',
                type: 'bar',
                data: [5, 20, 15]
            }
        ]
    };
    myChart2.setOption(option2);

    //未审批与未批准检验报告统计
    var myChart3 = echarts.init(document.getElementById('TestReport'));
    option3 = {
        title: {
            text: '未审批/未批准统计'
        },
        tooltip: {
            trigger: 'axis'
        },
        legend: {
            data: ['未审批', '未批准']
        },
        toolbox: {
            show: true,
            feature: {
                dataZoom: {
                    yAxisIndex: 'none'
                },
                dataView: { readOnly: false },
                magicType: { type: ['line', 'bar'] },
                restore: {},
                saveAsImage: {}
            }
        },
        xAxis: {
            type: 'category',
            boundaryGap: false,
            data: ['9月1号', '9月2号', '9月3号', '9月4号', '9月5号', '...', '9月30号']
        },
        yAxis: {
            //type: 'value',
            //axisLabel: {
            //    formatter: '{value} °C'
            //}
        },
        series: [
            {
                name: '未审批',
                type: 'line',
                data: [11, 11, 15, 13, 12, 13, 10]//,
                //markPoint: {
                //    data: [
                //        { type: 'max', name: '最大值' },
                //        { type: 'min', name: '最小值' }
                //    ]
                //},
                //markLine: {
                //    data: [
                //        { type: 'average', name: '平均值' }
                //    ]
                //}
            },
            {
                name: '未批准',
                type: 'line',
                data: [10, 9, 5, 12, 3, 10, 7]//,
                //markPoint: {
                //    data: [
                //        { name: '周最低', value: -2, xAxis: 1, yAxis: -1.5 }
                //    ]
                //},
                //markLine: {
                //    data: [
                //        { type: 'average', name: '平均值' },
                //        [{
                //            symbol: 'none',
                //            x: '90%',
                //            yAxis: 'max'
                //        }, {
                //            symbol: 'circle',
                //            label: {
                //                normal: {
                //                    position: 'start',
                //                    formatter: '最大值'
                //                }
                //            },
                //            type: 'max',
                //            name: '最高点'
                //        }]
                //    ]
                //}
            }
        ]
    };
    myChart3.setOption(option3);

</script>
